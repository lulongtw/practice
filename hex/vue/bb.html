<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
  <script src="https://unpkg.com/vuex@4"></script><!--引入vuex-->

  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Document</title>
</head>
<body>
  <div id="app"></div>
  <script type="text/x-template" id="apphtml">
    <input type="text" v-model='appword'>
    <br>
    <input  @click='refresh' type="button" value='submit'>
    <hr>
    <son></son>
  </script>
  <script type="text/x-template" id="sonhtml">
    {{sonWord}}
  </script>
  <script>
    let {createApp,ref,watch} = Vue;
    let {createStore} = Vuex
    let store = createStore({
      state(){
        return{
          word:"vuex"
        }
      },
      mutations:{
        updtWord(state,newVal){
          state.word = newVal
        }
      }
    })

    let son = {
      template:"#sonhtml",
      setup(){
        let sonWord = ref(store.state.word)
        watch(()=>store.state.word,
          ()=>{sonWord.value = store.state.word}
        )
        return{
          sonWord
        }
      }
    }
    let app = createApp({
      template:"#apphtml",
      components:{son:son},
      setup(){
        let appword = ref("");
        function refresh(){
          store.commit("updtWord",appword)
          console.log(store.state.word)
        }
        return {
          appword,refresh
        }
      }
    })
    app.mount("#app")
  </script>
</body>
</html>